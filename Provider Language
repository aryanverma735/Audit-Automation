WITH BASE AS (
    SELECT
        P.MSTR_PROV_ID,
        P.NPI,
        L.LANG_CD,
        L.LANG_WRTN_IND,
        L.LANG_SPKN_IND,
        C.CD_VAL_NM
    FROM PROV P
    JOIN IP_LANG L ON P.MSTR_PROV_ID = L.MSTR_PROV_ID
    JOIN CD_VAL C ON L.LANG_CD = C.CD_VAL_CD
    WHERE P.NPI = '1922119643'
      AND C.CD_VAL_NM = 'Bulgarian'
      AND L.LANG_WRTN_IND = 'Y'
      AND L.LANG_SPKN_IND = 'Y'
)
SELECT
    MSTR_PROV_ID,
    LANG_CD,
    NPI,
    CD_VAL_NM,
    LANG_WRTN_IND,
    LANG_SPKN_IND,
    CASE WHEN COUNT(*) > 0 THEN 'AUDIT PASS' ELSE 'AUDIT FAIL' END AS AUDIT_RESULT
FROM BASE
GROUP BY
    MSTR_PROV_ID,
    LANG_CD,
    NPI,
    CD_VAL_NM,
    LANG_WRTN_IND,
    LANG_SPKN_IND;
