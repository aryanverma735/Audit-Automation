WITH BASE AS (
SELECT * FROM PROV PP
JOIN IP_LANG P ON PP.MSTR_PROV_ID = P.MSTR_PROV_ID
JOIN CD_VAL C ON P.LANG_CD = C.CD_VAL_CD
WHERE 
PP.NPI = '1922119643'
AND UPPER(C.CD_VAL_NM) = UPPER('Bulgarian')
AND UPPER(P.LANG_WRTN_IND) = UPPER('Y')
AND UPPER(P.LANG_SPKN_IND) = UPPER('Y')
)
SELECT NPI, CD_VAL_NM, LANG_WRTN_IND, LANG_SPKN_IND,
CASE WHEN COUNT(*) > 0 THEN 'AUDIT PASS' ELSE 'AUDIT FAIL' END AS AUDIT_RESULT
FROM BASE
GROUP BY NPI, CD_VAL_NM, LANG_WRTN_IND, LANG_SPKN_IND
