WITH BASE AS(
SELECT *
FROM 
PROV 
JOIN PROV_DATA_MNGMNT P
  ON PROV.MSTR_PROV_ID = P.MSTR_PROV_ID
JOIN CD_VAL C
ON P.DATA_MNGMNT_TYPE_CD = C.CD_VAL_CD
JOIN CD_VAL CC
  ON P.DATA_MNGMNT_CTGRY_CD = CC.CD_VAL_CD
WHERE PROV.NPI = '1053816751'
AND CC.SHRT_DESC_TXT= 'Network Management'
AND C.SHRT_DESC_TXT = 'Solo Practitioner'
AND P.PDM_EFCTV_DT = TO_DATE('01/01/1901','MM/DD/YYYY')
)
SELECT 
CASE WHEN COUNT(*) > 0 THEN 'Audit Pass' ELSE 'Audit Fail' END AS ASDIT_RESULT 
FROM BASE

