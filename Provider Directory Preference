with base as(
        SELECT L.MSTR_PROV_ID,
        L.NPI,
        L.PROV_ORG_FED_TAX_ID,
        S_DIR.SPS_STNDRDZD_ADRS_ID,
        M_DIR.POA_KEY,
        NW.RGNL_NTWK_ID,
        N.DIR_DSPLY_IND

    FROM SPSOWNER.PROV L
    LEFT JOIN SPSOWNER.POA M_DIR
      ON M_DIR.MSTR_PROV_ID = L.MSTR_PROV_ID
    LEFT JOIN POA_NTWK N
      ON N.POA_KEY = M_DIR.POA_KEY
    LEFT JOIN POA_NTWK_CP NN
      ON NN.POA_NTWK_KEY = N.POA_NTWK_KEY
    LEFT JOIN POA_CNTCT PC
      ON PC.POA_KEY = M_DIR.POA_KEY
    LEFT JOIN PROV_ORG_NTWK PON
      ON PON.PROV_ORG_NTWK_KEY = N.PROV_ORG_NTWK_KEY
    LEFT JOIN NTWK NW
      ON NW.NTWK_KEY = PON.NTWK_KEY
    LEFT JOIN STNDRDZD_ADRS S_DIR
      ON S_DIR.SPS_STNDRDZD_ADRS_ID = M_DIR.SPS_STNDRDZD_ADRS_ID
    LEFT JOIN POFC_CHARSTC OC
      ON OC.POA_KEY = M_DIR.POA_KEY
    LEFT JOIN POFC_HOURS HR
      ON M_DIR.POA_KEY = HR.POA_KEY
    LEFT JOIN CD_VAL CD
      ON CD.CD_VAL_CD = OC.OFC_CHARSTC_CTGRY_CD
    LEFT JOIN CD_VAL CDD
      ON CDD.CD_VAL_CD = OC.OFC_CHARSTC_TYPE_CD   
    LEFT JOIN CD_VAL CDA
      ON CDA.CD_VAL_CD = HR.DAY_OF_THE_WEEK_CD
      
  WHERE L.MSTR_PROV_ID = '1105456499'
  AND M_DIR.POA_KEY = '6009899673'
  AND NW.RGNL_NTWK_ID IN ('BCCADV00','BCCPPO00','CADHECHW','CAEUSC00','CANTWKCSNP01','CANTWKPPOGRS','CANTWKPSNP01','CANWTKPPO101','CAPBNS00','CAPWC100','CAWCPERC','CAWCWC06')
  AND N.DIR_DSPLY_IND = 'D'
  )
  SELECT DISTINCT(RGNL_NTWK_ID),
  CASE WHEN COUNT(*) > 1 THEN 'AUDIT PASS' ELSE 'AUDIT FAIL' END AS AUDIT_RESULT
  FROM base
  GROUP BY RGNL_NTWK_ID
