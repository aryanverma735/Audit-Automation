
SELECT
  CASE
    WHEN COUNT(*) > 0
     AND COUNT(*) = SUM(CASE WHEN TRIM(J.ROLE_CD) = 'S' THEN 1 ELSE 0 END)
    THEN 'Audit pass'
    ELSE 'Audit fail'
  END AS audit_status
FROM SPSOWNER.RLTD_PADRS_NTWK J
JOIN SPSOWNER.RLTD_PADRS K
  ON K.RLTD_PADRS_KEY = J.RLTD_PADRS_KEY
JOIN SPSOWNER.PROV L_ORG
  ON L_ORG.MSTR_PROV_ID = K.MSTR_PROV_ID
 AND L_ORG.PROV_CTGRY_CD = '182'
JOIN SPSOWNER.PROV L_IND
  ON L_IND.MSTR_PROV_ID = K.RLTD_MSTR_PROV_ID
 AND L_IND.PROV_CTGRY_CD = '181'
JOIN SPSOWNER.POA_NTWK N
  ON N.POA_NTWK_KEY = J.POA_NTWK_KEY
JOIN SPSOWNER.PROV_ORG_NTWK PON
  ON PON.PROV_ORG_NTWK_KEY = N.PROV_ORG_NTWK_KEY
JOIN SPSOWNER.NTWK NW
  ON NW.NTWK_KEY = PON.NTWK_KEY
JOIN SPSOWNER.RLTD_PADRS_NTWK_SPCLTY RS
  ON RS.RLTD_PADRS_NTWK_KEY = J.RLTD_PADRS_NTWK_KEY
JOIN SPSOWNER.PROV_SPCLTY PS_RS
  ON PS_RS.PROV_SPCLTY_KEY = RS.PROV_SPCLTY_KEY
JOIN SPSOWNER.HLTHCR_PROV_TXNMY_CD_RFRNC H
  ON H.TXNMY_CD = PS_RS.TXNMY_CD
WHERE L_ORG.PROV_ORG_FED_TAX_ID = '593214635'
  AND L_IND.MSTR_PROV_ID = '1101814305'
  AND J.RLTD_PADRS_NTWK_TRMNTN_RSN_CD IS NULL;
